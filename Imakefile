XCOMM Imakefile / Makefile for Blackbox - an X11 Window manager
XCOMM Copyright (c) 1997, 1998 by Brad Hughes, bhughes@arn.net
XCOMM
XCOMM  This program is free software; you can redistribute it and/or modify
XCOMM  it under the terms of the GNU General Public License as published by
XCOMM  the Free Software Foundation; either version 2 of the License, or
XCOMM  (at your option) any later version.
XCOMM
XCOMM  This program is distributed in the hope that it will be useful,
XCOMM  but WITHOUT ANY WARRANTY; without even the implied warranty of
XCOMM  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
XCOMM  GNU General Public License for more details.
XCOMM
XCOMM  You should have received a copy of the GNU General Public License
XCOMM  along with this program; if not, write to the Free Software
XCOMM  Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
XCOMM
XCOMM (See the included file COPYING / GPL-2.0)
XCOMM

XCOMM
XCOMM Various defines for building blackbox

INC =		blackbox.hh debug.hh graphics.hh icon.hh llist.hh \
		menu.hh session.hh window.hh workspace.hh
SRC =		blackbox.cc debug.cc graphics.cc icon.cc llist.cc \
		main.cc menu.cc session.cc sessionmenu.cc window.cc \
		windowmenu.cc workspace.cc workspacemenu.cc
OBJ =		blackbox.o debug.o graphics.o icon.o main.o menu.o \
		llist.o session.o sessionmenu.o window.o windowmenu.o \
		workspace.o workspacemenu.o
EXTRA_DEFS =	-Wall -W -DSHAPE
DEFAULTS_PATH =	-DXAPPLOADDIR=\"$(XAPPLOADDIR)\" -DXLIBDIR=\"$(LIBDIR)\"
LIBS =		$(XLIB) $(EXTENSIONLIB)

XCOMM
XCOMM Tell imake to generate our rules

PROGRAMS = blackbox
SRCS1 = $(SRC)
OBJS1 = $(OBJ)
ComplexProgramTarget_1(blackbox, $(LIBS), $(OTHER_LIBS))

.cc.o: $(SRC)
	$(CXX) $(CXXFLAGS) $(EXTRA_DEFS) -c -o $@ $<
XCOMM
XCOMM Comment out the above and un-comment below to get debugging symbols
XCOMM
XCOMM	$(CXX) -g -I$(INCDIR) $(EXTRA_DEFS) -c -o $@ $<

session.o: session.cc
	$(CXX) $(CXXFLAGS) $(EXTRA_DEFS) $(DEFAULTS_PATH) -c -o $@ $<
XCOMM
XCOMM Comment out the above and un-comment below to get debugging symbols
XCOMM
XCOMM	$(CXX) -g -I$(INCDIR) $(EXTRA_DEFS) $(DEFAULTS_PATH) -c -o $@ $<

depend:: 
	rm -f Makefile.bak

install:: install.app-defaults
install.app-defaults::
	@if [ ! -d $(XAPPLOADDIR) ]; then \
		$(MKDIRHIER) $(XAPPLOADDIR); \
	fi
	$(INSTALL) $(INSTALLFLAGS) $(INSTMANFLAGS) Blackbox.ad $(XAPPLOADDIR)/Blackbox.ad
	@if [ ! -d $(LIBDIR)/Blackbox ]; then \
		$(MKDIRHIER) $(LIBDIR)/Blackbox; \
	fi
	$(INSTALL) $(INSTALLFLAGS) $(INSTMANFLAGS) Menu.ad $(LIBDIR)/Blackbox/Menu.ad

XCOMM
XCOMM Make rules I enjoy

distclean::
	make clean
	rm -f Makefile

new:: 
	make clean
	make all

dist::
	make distclean
	xmkmf -a
	make all
